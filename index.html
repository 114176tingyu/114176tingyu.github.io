<!DOCTYPE html>
<html lang="zh-Hant">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>È§µÂ∏ïÊÅ∞Áãó</title>
<style>
    body {
        display: flex;
        justify-content: center;
        align-items: center;
        height: 100vh;
        background: #f6f8ff;
        font-family: "Noto Sans TC", sans-serif;
    }

    .game {
        display: flex;
        gap: 40px;
        align-items: center;
    }

    .basket {
        width: 180px;
        padding: 15px;
        background: #f0d5a1;
        border: 4px solid #b8874b;
        border-radius: 15px;
        text-align: center;
    }

    .item {
        width: 80px;
        margin: 10px auto;
        cursor: grab;
        user-select: none;
    }

    #pachi {
        width: 300px;
        transition: filter .2s, transform .2s;
    }

    .dragging {
        position: absolute;
        pointer-events: none;
        transform: translate(-50%, -50%);
        width: 80px;
    }
</style>
</head>
<body>

<div class="game">

    <div class="basket">
        <h3>üß∫ Á±ÉÂ≠ê</h3>
        <img class="item" data-type="carrot" src="carrot.png">
        <img class="item" data-type="banana" src="banana.png">
    </div>

    <!-- ÂàùÂßãÁÇ∫ÈñâÂò¥ÁâàÊú¨ -->
    <img id="pachi" src="pachi_close.png">
</div>

<script>
    const pachi = document.getElementById("pachi");
    const basket = document.querySelector(".basket");

    let draggingItem = null;
    let originalItem = null;

    function spawnFood(type) {
        const img = document.createElement("img");
        img.className = "item";
        img.dataset.type = type;
        img.src = type === "carrot" ? "carrot.png" : "banana.png";
        basket.appendChild(img);
        makeDraggable(img);
    }

    function makeDraggable(item) {
       item.addEventListener("mousedown", (e) => {
    if (feedCount >= MAX_FEED) return;
            originalItem = item;

            draggingItem = item.cloneNode(true);
            draggingItem.classList.add("dragging");
            document.body.appendChild(draggingItem);

            item.style.opacity = 0.3;
            moveDragged(e);
        });
    }

    function moveDragged(e) {
        if (!draggingItem) return;
        draggingItem.style.left = e.pageX + "px";
        draggingItem.style.top = e.pageY + "px";

        const mouth = pachi.getBoundingClientRect();

        const nearMouth =
            e.pageX > mouth.left + 40 &&
            e.pageX < mouth.right - 40 &&
            e.pageY > mouth.top + mouth.height * 0.40 &&
            e.pageY < mouth.bottom;

        // Èù†ËøëÂò¥ ‚Üí ÂºµÂò¥
        if (nearMouth) {
            pachi.src = "pachi_open.png";
        } else {
            pachi.src = "pachi_close.png";
        }
    }

    document.addEventListener("mousemove", moveDragged);

    document.addEventListener("mouseup", (e) => {
        if (!draggingItem) return;

        const mouth = pachi.getBoundingClientRect();
        const inMouth =
            e.pageX > mouth.left + 40 &&
            e.pageX < mouth.right - 40 &&
            e.pageY > mouth.top + mouth.height * 0.45 &&
            e.pageY < mouth.bottom;

        const type = draggingItem.dataset.type;

        if (inMouth) {
            // ÂêÉÊéâ
            pachi.src = "pachi_open.png";
            setTimeout(() => {
                pachi.src = "pachi_close.png";
            }, 300);

            spawnFood(type);
        } else {
            pachi.src = "pachi_close.png";
        }

        draggingItem.remove();
        draggingItem = null;

        if (originalItem) {
            originalItem.style.opacity = 1;
        }
    });

    document.querySelectorAll(".item").forEach(makeDraggable);
</script>

</body>
</html>
